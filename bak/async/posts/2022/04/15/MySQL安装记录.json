{"tags":[{"name":"数据库","permalink":"https://xuanxiaoming.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/","url":"/async/tags/数据库.json","count":5}],"categories":[],"url":"/async/posts/2022/04/15/MySQL安装记录.json","date":1649959417000,"path":{"year":2022,"month":4,"day":15,"name":"MySQL安装记录"},"title":"MySQL安装记录","permalink":"https://xuanxiaoming.github.io/2022/04/15/MySQL%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95/","content":"<h3 id=\"首先是卸载问题：如果安装-mysql-错误，请按如下标准卸载：\"><a href=\"#首先是卸载问题：如果安装-mysql-错误，请按如下标准卸载：\" class=\"headerlink\" title=\"首先是卸载问题：如果安装 mysql 错误，请按如下标准卸载：\"></a>首先是卸载问题：如果安装 mysql 错误，请按如下标准卸载：</h3><pre class=\"line-numbers language-shell\"><code class=\"language-shell\"># 关闭mysql服务\nsudo service stop mysql；\n\n# 清除所有mysql包\nsudo apt purge mysql-server mysql-client mysql-common mysql-server-core-* mysql-client-core-*\n\n# 删除所有mysql文件\nsudo rm -rf /etc/mysql /var/lib/mysql /var/log/mysql\n\n# 最后清理所有不需要的包\nsudo apt autoremove\nsudo apt autoclean<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"找不到-var-run-mysqld-mysqld-sock-报错\"><a href=\"#找不到-var-run-mysqld-mysqld-sock-报错\" class=\"headerlink\" title=\"找不到 /var/run/mysqld/mysqld.sock 报错\"></a>找不到 /var/run/mysqld/mysqld.sock 报错</h3><p>如果启动 mysql 时遇到 <code>Error: Can&#39;t connect to local MySQL server through socket &#39;/var/run/mysqld/mysqld.sock&#39; (2)</code>，请仔细确认安装时是否有报错信息，根据报错原因去解决问题。</p>\n<p>这类问题主要是my.cnf的配置指向错误，网上解决办法有很多种，请自行选择。</p>\n<p>我自己遇到的是安装时提示 <code>mysql-server depends on mysql-server-8.0</code>，因为我是直接安装的 <code>mysq-server</code>，卸载重装时将安装包改为 <code>mysql-server-8.0</code> 就好了。</p>\n<pre class=\"line-numbers language-shell\"><code class=\"language-shell\">apt install -y mysql-server-8.0 mysql-common<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3 id=\"初始化mysql\"><a href=\"#初始化mysql\" class=\"headerlink\" title=\"初始化mysql\"></a>初始化mysql</h3><p>在使用 mysql 前，先使用 <code>mysql_secure_installation</code> 初始化数据库。</p>\n<blockquote>\n<p>初始化数据库遇到 <code># Failed! Error: SET PASSWORD has no significance for user ‘root’@’localhost’ as the authentication method used doesn’t store authentication data in the MySQL server</code>, 先退出进程，直接mysql进入数据库，运行 <code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password by &#39;mynewpassword&#39;;’</code> 更改身份验证参数，然后重新初始化。（密码为 mynewpassword）</p>\n</blockquote>\n<p>附上初始化过程：</p>\n<pre class=\"line-numbers language-shell\"><code class=\"language-shell\">root@6f72ddf70108:/# mysql_secure_installation\n\nSecuring the MySQL server deployment.\n\nEnter password for user root: \nThe 'validate_password' component is installed on the server.\nThe subsequent steps will run with the existing configuration\nof the component.\nUsing existing password for root.\n\nEstimated strength of the password: 50 \nChange the password for root ? ((Press y|Y for Yes, any other key for No) : y\n\nNew password: \n\nRe-enter new password: \n\nEstimated strength of the password: 0 \nDo you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : y\n ... Failed! Error: Your password does not satisfy the current policy requirements\n\nNew password: \n\nRe-enter new password: \nSorry, passwords do not match.\n\nNew password: \n\nRe-enter new password: \n\nEstimated strength of the password: 50 \nDo you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : y\nBy default, a MySQL installation has an anonymous user,\nallowing anyone to log into MySQL without having to have\na user account created for them. This is intended only for\ntesting, and to make the installation go a bit smoother.\nYou should remove them before moving into a production\nenvironment.\n\nRemove anonymous users? (Press y|Y for Yes, any other key for No) : y\nSuccess.\n\n\nNormally, root should only be allowed to connect from\n'localhost'. This ensures that someone cannot guess at\nthe root password from the network.\n\nDisallow root login remotely? (Press y|Y for Yes, any other key for No) : n\n\n ... skipping.\nBy default, MySQL comes with a database named 'test' that\nanyone can access. This is also intended only for testing,\nand should be removed before moving into a production\nenvironment.\n\n\nRemove test database and access to it? (Press y|Y for Yes, any other key for No) : y\n - Dropping test database...\nSuccess.\n\n - Removing privileges on test database...\nSuccess.\n\nReloading the privilege tables will ensure that all changes\nmade so far will take effect immediately.\n\nReload privilege tables now? (Press y|Y for Yes, any other key for No) : y\nSuccess.\n\nAll done! <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"mysql-启动失败：su-warning-cannot-change-directory-to-nonexistent-No-such-file-or-directory\"><a href=\"#mysql-启动失败：su-warning-cannot-change-directory-to-nonexistent-No-such-file-or-directory\" class=\"headerlink\" title=\"mysql 启动失败：su: warning: cannot change directory to /nonexistent: No such file or directory\"></a>mysql 启动失败：su: warning: cannot change directory to /nonexistent: No such file or directory</h3><pre class=\"line-numbers language-shell\"><code class=\"language-shell\">sudo service mysql stop\nsudo usermod -d /var/lib/mysql/ mysql\nsudo service mysql start<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n"}